<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI 강아지 하네스 쇼핑봇 🐶</title>
<style>
body { font-family:'Noto Sans KR',sans-serif; background:#f4f6f8; display:flex; justify-content:center; align-items:center; height:100vh; margin:0; }
#chatbox { width:400px; height:600px; background:white; border-radius:15px; display:flex; flex-direction:column; overflow:hidden; box-shadow:0 0 15px rgba(0,0,0,0.1); }
#messages { flex:1; overflow-y:auto; padding:15px; }
.msg { margin:10px 0; padding:10px 12px; border-radius:12px; line-height:1.4; max-width:85%; word-wrap:break-word; }
.user { background:#007bff; color:white; align-self:flex-end; }
.ai { background:#e9ecef; color:#000; align-self:flex-start; }
.product-card { border:1px solid #ddd; border-radius:10px; padding:8px; margin-top:8px; text-align:center; }
.product-card img { width:100%; border-radius:8px; margin-bottom:5px; }
.buy-btn { display:inline-block; background:#ff7b00; color:white; padding:8px 12px; border-radius:8px; text-decoration:none; font-weight:bold; }
.buy-btn:hover { background:#ff9b2b; }
#input-area { display:flex; border-top:1px solid #ddd; }
#input-area input { flex:1; padding:10px; border:none; outline:none; font-size:15px; }
#input-area button { background:#007bff; border:none; color:white; padding:10px 15px; cursor:pointer; font-weight:bold; }
</style>
</head>
<body>
<div id="chatbox">
  <div id="messages"></div>
  <div id="input-area">
    <input type="text" id="userInput" placeholder="하네스를 추천받아보세요...">
    <button id="sendBtn">보내기</button>
  </div>
</div>
<script>
const messagesDiv = document.getElementById("messages");

function addMessage(text,sender="ai",product=null){
  const msg=document.createElement("div");
  msg.classList.add("msg",sender);
  msg.innerHTML=text;
  messagesDiv.appendChild(msg);
  if(product){
    const card=document.createElement("div");
    card.classList.add("product-card");
    card.innerHTML=`<img src="${product.image}" alt="${product.name}"><strong>${product.name}</strong><br><span>${product.price}</span><br><a href="${product.link}" target="_blank" class="buy-btn">구매하기</a>`;
    messagesDiv.appendChild(card);
  }
  messagesDiv.scrollTop=messagesDiv.scrollHeight;
}

async function sendMessage(){
  const input=document.getElementById("userInput");
  const userText=input.value.trim();
  if(!userText) return;
  addMessage(userText,"user");
  input.value="";
  const response=await fetch("/chat", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({message:userText})
  });
  const data=await response.json();
  addMessage(data.reply,"ai",data.product);
}

document.getElementById("sendBtn").onclick=sendMessage;
document.getElementById("userInput").addEventListener("keypress",e=>{if(e.key==="Enter") sendMessage();});

addMessage("안녕하세요 🐶 강아지 하네스 쇼핑 도우미입니다! 어떤 스타일의 하네스를 찾고 계신가요?");
</script>
</body>
</html>
